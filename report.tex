\input{./Templates/header}

\title{研究結果報告:\\
再帰的ニューラルネットワークとトリプレットユニットによる物体間関係認識}
\author{中山研究室}
\begin{document}
\maketitle

%========================================================================


\section{概要}
風景や物体などの一般的な環境を撮影した画像から，画像内の情報を物体間関係性の集合として出力する手法を提案する．本論文では画像内に含まれれる物体同士の関係を認識することを物体間関係認識と呼び，さらに物体間関係の集合を出力することを物体間関係集合認識と呼ぶ．タスクとしては一般画像からその画像内に含まれる物体と，それら物体同士の関係性の集合を出力する．

物体間関係性に関する問題を機械学習で取り扱う場合，そのクラス数が大きな問題となる．関係性をfactと呼び，factを構成する要素をsubject, predicate, objectとする．(subject, predicate, object)のタプル(トリプレット)として考慮しなければならないfactのクラス数$N_f$は各要素それぞれのクラス数($N_s,N_p,N_o$)の積となり，それぞれの増加と共に爆発的に増加してしまう．既存研究による物体間関係性認識では構造学習とランキング学習による手法が一般的で，それらは全てのfactに対するスコアを計算する．この時，$N_f$の爆発的な増加と共に計算量が大きく増加してしまう問題がある．さらに，スコアに基づいたモデルは画像に関する説明的な関係性の集合を出力するには適していないという問題がある．

本研究では再帰的ニューラルネットワーク(RNN)とトリプレットユニットを用いたモデルを提案し，クラス数に関する計算量の問題を解決する．さらに，RNNの学習に用いる損失関数を画像に対する関係性の集合全体に対して設計することで，ベースラインとしたモデルと比較してより様々な単語を用いた関係性の集合を出力する．

%========================================================================
\section{関連研究}
物体間関係認識の関連研究として，物体関係のランキングによる手法\cite{Sadeghi2011,CewuLuRanjayKrishnaMichaelBernstein,Atzmon2016}が提案されている．しかし，ランキングによる既存手法では考えられる全てのfactのスコアを計算する必要があり，factの数に関するスケーラビリティが課題となる．
もう一つの問題として，シーングラフを構成するような物体間関係集合認識のためには出力される集合全体の性質を捉える必要が有るのに対して，既存手法は一つの関係性にのみ注目してスコアを計算している．
%========================================================================

%========================================================================
\section{提案手法}
クラス数に関するスケーラビリティを確保するために全てのfactに関するスコアの計算を避け，更に集合全体に対して最適化を行うために，提案手法として再帰的ニューラルネットワークとトリプレットユニットによるモデルを図\ref{fig:figs/lstm-triplet-resume}に示す．
\inputfig{figs/lstm-triplet-resume}{再帰的ニューラルネットワークとトリプレットユニットによる提案手法
}{0.4}

提案手法は再帰的ニューラルネットワークの内部状態を更新しながら逐次的にfactを出力し，最終的な集合の出力とする．各出力時に内部状態を物体間関係性に変換する部分をトリプレットユニットと呼び，本論文では２つを提案する．ひとつは内部状態を一度に物体間関係性に変換するSubject-Predicate-Object at once(SPO)．もう一つは内部状態から２つの物体認識を行ったあと，物体認識の結果から関係性を予測するモデルSubject-Object then Predicate(SOP)である．

最大$k$個のfactを集合として出力する際の，提案手法による計算量と既存手法の計算量を表\ref{table:calc-cost}に示す．
\begin{table}
\begin{center}
\caption{提案手法と関連研究手法の，$k$個の関係性出力に必要な計算量の比較．$M$は物体検出器の検出した領域数，$N$は$N \approx N_s \approx N_p \approx N_o$として示している．}
\label{table:calc-cost}
\begin{tabular}{lrr}
\toprule
手法 &  計算量 \\
\midrule
MLP-Rank (ベースライン)										&	$O(kN)$		\\
SPO	(提案手法1)												&	$O(kN)$		\\
SOP (提案手法2)												&	$O(kN^2)$	\\
\midrule
Visual Phrases\cite{Sadeghi2011}								&	$O(kMN^3)$  \\
VRD\cite{CewuLuRanjayKrishnaMichaelBernstein}				&	$O(kM^2N^3)$\\
SSVM\cite{Atzmon2016}										&	$O(kM^2N^2)$\\
\bottomrule
\end{tabular}
\end{center}
\end{table}
%------------------------------------------------------------------------------------
\begin{table}
\begin{center}
\caption{提案手法と関連研究手法の，$k$個の関係性出力に必要な計算量の比較．$M$は物体検出器の検出した領域数，$N$は$N \approx N_s \approx N_p \approx N_o$として示している．}
\label{table:calc-cost}
\begin{tabular}{lrr}
\toprule
Model &  Cost \\
\midrule
MLP-Rank (Baseline)										&	$O(kN)$		\\
SPO	(Proposal 1)												&	$O(kN)$		\\
SOP (Proposal 2)												&	$O(kN^2)$	\\
\midrule
Visual Phrases [Sadeghi 2011]								&	$O(kMN^3)$  \\
VRD [Cewu 2016]				&	$O(kM^2N^3)$\\
SSVM [Atzmon 2016]										&	$O(kM^2N^2)$\\
\bottomrule
\end{tabular}
\end{center}
\end{table}
%------------------------------------------------------------------------------------
関連研究は物体領域情報を用いているなど,利用されている特徴量と計算量が提案手法と大きく異なるため,性能をそのまま比較することが妥当ではない.提案手法と同等の特徴量と計算量を持ったベースラインとなる手法として,MLP-Rankを実装した.MLP-Rankは関連研究で用いられたモデルから物体領域情報を取り除き,計算量について同等となるように改変を行ったものである.

\section{実験}

実験の目的は主に3つである．一つはモデルのクラス数に関するスケーラビリティの確認．二つ目はベースラインと提案手法の出力する集合の性質の違いの確認．そしてトリプレットユニットの汎化性能の確認である．

スケーラビリティの確認のためにクラス数が可変なデータセット(CSK)を作製し，様々なクラス数での実験を行った．CSKの詳細を表\ref{table:dataset-stats}に示す．Precision@kとRecall@kの評価結果を図\ref{fig:figs/prec-recall-resume}に示す．この図から，$k$がデータセットの平均fact数に近い範囲では,クラス数が増えた場合に計算量を抑えた提案手法がベースラインよりも良い性能を出していることが確認できる．ランキングを用いたモデルはkを増やすほどにRecall@kが増加するが,提案手法はその傾向が抑えられている.これは,提案手法はデータセットで示された物体間関係集合と同様の数の関係性を出力するように最適化されており,それ以上の出力数については重複が多くなるためである.次に２つのトリプレットユニット,SPOとSOPを比較すると,SOPが最もよい汎化性能を出していることが確認できた．

図\ref{fig:figs/input-graph}と図\ref{fig:figs/output-graph}が，モデルに対する入力画像と出力された集合の例である．これらの結果から，提案手法とベースラインの出力の性質に違いがあることがわかる．教師ラベルは手作業ででラベルを作製する際に,同じ単語をなるべく用いず,違った表現で物体間関係を追加するように作製されている.このため,ラベル集合は各グラフ同士の接続が少なく,多くの単語が用いられている.定量的な評価のため，一枚の画像の表現に用いられる単語の種類数の平均を表\ref{table:mean-used-words}に示す.これに対してランキングによる出力では,物体間関係集合の性質を考慮しないために,比較的少ない種類の単語の組み合わせで集合を構築していることがわかる.提案手法ではベースラインと比較して,より多くの単語を用いている.
%---------------------------------------------
\begin{table}
\begin{center}
\caption{CSK1000に出現する一枚の画像に対する，出力された集合含まれる単語の種類数の平均. top-$k$の$k=20$としたときの出力結果.}
\label{table:mean-used-words}
\begin{tabular}{lrrrr}
\toprule
Model & MLP-Rank& SPO &  SOP & 正解ラベル\\
\midrule
平均単語種類数	& 11.0 	& 14.4 & 15.9 & 15.6\\
\bottomrule
\end{tabular}
\end{center}
\end{table}
%--------------------------------------------
\begin{table}
\begin{center}
\caption{$\overline{|facts|/I}$は各画像にラベル付されたfactの数の平均．$N_f$は考慮しなければならないクラス数. $N_f'$はデータセットに実際に含まれていたfactのクラス数.}
\label{table:dataset-stats}
\begin{tabular}{lrrrrrrr}
\toprule
name &      $\overline{|facts|/I}$ &  $N_f$ &  $N_f'$ &  $N_s$ &  $N_p$ &  $N_o$ \\
\midrule
CSK5              &   1.21 &             \textbf{125} &       50 &           5 &             5 &          5 \\
CSK100            &   4.11 &       \textbf{850000} &    30117 &         100 &            85 &        100 \\
CSK1000           &  10.51 &       \textbf{833918730} &   253764 &         894 &           985 &        947 \\
\bottomrule
\end{tabular}
\end{center}
\end{table}
\inputfig{figs/prec-recall-resume}{クラス数を増やしていった際のPrecision@kとRecall@k}{0.32}
\inputfig{figs/input-graph}{入力画像}{0.2}
\inputfig{figs/output-graph}{出力された物体間関係集合と教師ラベル}{0.35}
\section{結論}

本研究では，一般画像を説明する物体関係の集合を画像から検出する問題に取り組んだ．物体間関係認識を目的とした既存研究の，全ての関係性のランキングを軸にした手法に対して，再帰的ニューラルネットワークを用いた提案手法によって本研究は次の貢献を行った．
	\begin{itemize}
		\item 物体間関係集合出力を目的としてRNNを応用しトリプレットユニットを用いたモデルを提案
		\item クラス数爆発に伴う計算量問題をトリプレットユニットを用いて解決
		\item 基本的なトリプレットユニットより汎化性能を持ったものとしてSOPを提案
		\item 関係集合に対して最適化することで，より多くの単語を含むシーングラフに近い関係集合を出力
	\end{itemize}

以上が，本研究の報告である．
%========================================================================

%\section{今後の課題}
%	提案手法は物体間関係集合の出力に対する最適化という点で従来手法と比較して将来性を持っている．しかし，現段階で得られる出力の精度については，従来手法に大きな優位性がある．提案手法の発展系として精度を高めるには，物体領域検出器を導入するか，それと同等な機能を持った機械学習構造の導入が考えられる．したがって，計算量とのトレードオフがある中でいかに出力の精度を高めていくかが重要な課題である．

%========================================================================
\bibliographystyle{plain}
\bibliography{./BibTeX/references,./BibTeX/references-short}

\end{document}
